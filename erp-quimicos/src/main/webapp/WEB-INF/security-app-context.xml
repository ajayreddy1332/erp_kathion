<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security" 
xmlns:beans="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       
       xsi:schemaLocation="http://www.springframework.org/schema/beans 
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/security
       http://www.springframework.org/schema/security/spring-security-3.1.xsd
       ">
        
        
    <global-method-security secured-annotations="disabled">
    </global-method-security>
    
    <http auto-config="true">
        <!--Noe-->
        <intercept-url pattern="/controllers/home/startup.agnux" access="ROLE_ADMIN,ROLE_CONSULTAS_ALMACEN,ROLE_ALTA_PRODUCTO,ROLE_ALTA_PROVEEDOR,ROLE_ALTA_CLIENTE,ROLE_VENTAS,ROLE_FACTURAS_COMPRAS,ROLE_FACTURACION,ROLE_COBRANZA,ROLE_ALTA_AGENTE,ROLE_FAC_PROVEEDOR,ROLE_AUTORIZA_PEDIDO,ROLE_CREDITOS,ROLE_REPORTE_CXC_PRONOSTICO,ROLE_REPORTE_REMISIONES,ROLE_CXC_REPORTE_VENTAS,ROLE_REPORTE_FACTURAS,ROLE_ALTA_FORMULA,ROLE_REPORTE_ANT_SALDOS_CXC,ROLE_REPORTE_PROG_PAGOS,ROLE_ALTA_BANCOS,ROLE_ALTA_CHEQUERA,ROLE_NOTA_CREDITO,ROLE_PROGRAMA_RUTA,ROLE_REPORTE_ESTADISTICO_VENTAS,ROLE_REPORTE_PEDIDOS,ROLE_CONFIG_PRODUCCION,ROLE_ASIGNA_RUTA,ROLE_ALTA_UNIDAD_MEDIDA,ROLE_ALTA_VEHICULO,ROLE_FAC_DEVOLUCIONES,ROLE_ALTA_PUESTO,ROLE_COTIZACION,ROLE_PAGOS_CXP,ROLE_ANTICIPOS_CXP,ROLE_ALTA_FAMILIA,ROLE_ALTA_SUBFAMILIA,ROLE_REPORTE_COBRANZA_DIARIA,ROLE_ORDEN_DE_ENTRADA,ROLE_ORDEN_DE_SALIDA,ROLE_AJUSTE_INVENTARIO,ROLE_ALTA_EMPLEADO, ROLE_ORDEN_COMPRA,ROLE_AUTORIZACION_ORDEN_COMPRA,ROLE_REPORTE_REMISIONES_FACTURADAS,ROLE_ORDEN_PRODUCCION,ROLE_PREORDEN_PRODUCCION,ROLE_ALTA_ESCOLARIDAD,ROLE_ALTA_RELIGION,ROLE_ALTA_TIPO_SANGRE,ROLE_ALTA_TIPO_EQUIPO,ROLE_ALTA_DIA_NO_LABORABLE,ROLE_ALTA_CATGORIA_EMPLEADO,ROLE_ALTA_DEPARTAMENTO,ROLE_ALTA_TURNO,ROLE_IMPRESION_ETIQUETAS,ROLE_NOTA_CREDITO_PROVEEDOR,ROLE_REP_EDOCTA_PROVEEDOR,ROLE_ACTUALIZA_CODIGO_ISO,ROLE_REPORTE_EXIS_LOTE,ROLE_DEVOLUCION_A_PROVEEDOR,ROLE_TRASPASOS,ROLE_ORDEN_TRASPASO, ROLE_CAT_CENTRO_COSTO,ROLE_CAT_TIPO_POLIZA,ROLE_CAT_CTA_MAYOR,ROLE_CAT_CON_CONTABLE,ROLE_CAT_CTAS_CONTABLES,ROLE_LISTA_PRECIOS,ROLE_DIR_FISCAL_CLIENTE,ROLE_CRM_REGISTRO_VISITA" />
        
        <intercept-url pattern="/controllers/productos/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_PRODUCTO" />
        <intercept-url pattern="/controllers/proveedores/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_PROVEEDOR" />
        <intercept-url pattern="/controllers/clients/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_CLIENTE" />
        <intercept-url pattern="/controllers/cotizaciones/startup.agnux" access="ROLE_ADMIN,ROLE_COTIZACION" /><!--Pendiente-->
        <intercept-url pattern="/controllers/entradamercancias/startup.agnux" access="ROLE_ADMIN,ROLE_FACTURAS_COMPRAS" />
        <intercept-url pattern="/controllers/prefacturas/startup.agnux" access="ROLE_ADMIN,ROLE_FACTURACION" />
        <intercept-url pattern="/controllers/facturas/startup.agnux" access="ROLE_ADMIN,ROLE_FACTURACION" />
        <intercept-url pattern="/controllers/carteras/startup.agnux" access="ROLE_ADMIN,ROLE_COBRANZA" />
        <intercept-url pattern="/controllers/agentes/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_AGENTE" />
        <intercept-url pattern="/controllers/clientsclasif1/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/clientsclasif2/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/clientsclasif3/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/provfacturas/startup.agnux" access="ROLE_ADMIN,ROLE_FAC_PROVEEDOR" />
        <intercept-url pattern="/controllers/ordenesproduccion/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/almacenes/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invprodfamilias/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_FAMILIA" />
        <intercept-url pattern="/controllers/invprodsubfamilias/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_SUBFAMILIA" />
        <intercept-url pattern="/controllers/proveedorespagos/startup.agnux" access="ROLE_ADMIN,ROLE_PAGOS_CXP" />
        <intercept-url pattern="/controllers/proveedoresanticipos/startup.agnux" access="ROLE_ADMIN,ROLE_ANTICIPOS_CXP" /><!--pendiente terminar -->
        <intercept-url pattern="/controllers/pocpedidos/startup.agnux" access="ROLE_ADMIN,ROLE_VENTAS" />
        <intercept-url pattern="/controllers/pocpedidosautoriza/startup.agnux" access="ROLE_ADMIN,ROLE_AUTORIZA_PEDIDO" />
        <intercept-url pattern="/controllers/remisiones/startup.agnux" access="ROLE_ADMIN,ROLE_FACTURACION" />
        <intercept-url pattern="/controllers/notascredito/startup.agnux" access="ROLE_ADMIN,ROLE_NOTA_CREDITO" />
        <intercept-url pattern="/controllers/programacionrutas/startup.agnux" access="ROLE_ADMIN,ROLE_PROGRAMA_RUTA" />
        <intercept-url pattern="/controllers/facdevoluciones/startup.agnux" access="ROLE_ADMIN,ROLE_FAC_DEVOLUCIONES" />
        <intercept-url pattern="/controllers/invordenentrada/startup.agnux" access="ROLE_ADMIN,ROLE_ORDEN_DE_ENTRADA" />
        <intercept-url pattern="/controllers/invordensalida/startup.agnux" access="ROLE_ADMIN,ROLE_ORDEN_DE_SALIDA" />
        <intercept-url pattern="/controllers/invajustes/startup.agnux" access="ROLE_ADMIN,ROLE_AJUSTE_INVENTARIO" />
        <intercept-url pattern="/controllers/provnotascredito/startup.agnux" access="ROLE_ADMIN,ROLE_NOTA_CREDITO_PROVEEDOR" />
        <intercept-url pattern="/controllers/comfacdevolucion/startup.agnux" access="ROLE_ADMIN,ROLE_DEVOLUCION_A_PROVEEDOR" />
        <intercept-url pattern="/controllers/invtraspasos/startup.agnux" access="ROLE_ADMIN,ROLE_TRASPASOS" />
        <intercept-url pattern="/controllers/invordentras/startup.agnux" access="ROLE_ADMIN,ROLE_ORDEN_TRASPASO" />
        <intercept-url pattern="/controllers/clientsdf/startup.agnux" access="ROLE_ADMIN,ROLE_DIR_FISCAL_CLIENTE" />
        
        <intercept-url pattern="/controllers/centrocostos/startup.agnux" access="ROLE_ADMIN,ROLE_CAT_CENTRO_COSTO" />
        <intercept-url pattern="/controllers/tipopolizas/startup.agnux" access="ROLE_ADMIN,ROLE_CAT_TIPO_POLIZA" />
        <intercept-url pattern="/controllers/cuentasmayor/startup.agnux" access="ROLE_ADMIN,ROLE_CAT_CTA_MAYOR" />
        <intercept-url pattern="/controllers/conceptoscontables/startup.agnux" access="ROLE_ADMIN,ROLE_CAT_CON_CONTABLE" />
        <intercept-url pattern="/controllers/cuentascontables/startup.agnux" access="ROLE_ADMIN,ROLE_CAT_CTAS_CONTABLES" />
        
        
        <intercept-url pattern="/controllers/crmregistrovisitas/startup.agnux" access="ROLE_ADMIN,ROLE_CRM_REGISTRO_VISITA" />
        
        
        <intercept-url pattern="/controllers/repinvexis/startup.agnux" access="ROLE_ADMIN,ROLE_CONSULTAS_ALMACEN" />
        <intercept-url pattern="/controllers/repfacturacion/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_FACTURAS" />
        <intercept-url pattern="/controllers/repedoctacliente/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_EDO_CTA_CLIENTE" />
        <intercept-url pattern="/controllers/invrepcomprasnetasporproducto/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/repantiguedadsaldocliente/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_ANT_SALDOS_CXC" />
        <intercept-url pattern="/controllers/repinvexislote/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_EXIS_LOTE" />
        
        
        <!--vale-->
        <intercept-url pattern="/controllers/clientsgrupos/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/clientszonas/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/proveedoresclasif1/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/proveedoresclasif2/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/proveedoresclasif3/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/proveedoresgrupos/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/proveedoreszonas/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/clientstmovimientos/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/proveedorestmovimientos/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invclasif/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invclasificacionstock/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invunidades/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_UNIDAD_MEDIDA" />
        <intercept-url pattern="/controllers/proveedoresdirecciones/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/teschequera/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_CHEQUERA" />
        <intercept-url pattern="/controllers/invformulas/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_FORMULA" />
        <intercept-url pattern="/controllers/logasignarutas/startup.agnux" access="ROLE_ADMIN,ROLE_ASIGNA_RUTA" />
        <intercept-url pattern="/controllers/comordencompra/startup.agnux" access="ROLE_ADMIN,ROLE_ORDEN_COMPRA" />
        <intercept-url pattern="/controllers/comcompraautorizacion/startup.agnux" access="ROLE_ADMIN,ROLE_AUTORIZACION_ORDEN_COMPRA" /><!--Craedo por Luis Garcia-->
        <intercept-url pattern="/controllers/invetiquetas/startup.agnux" access="ROLE_ADMIN,ROLE_IMPRESION_ETIQUETAS" />
        
        
        <intercept-url pattern="/controllers/reppronoscobranza/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_CXC_PRONOSTICO" />
        <intercept-url pattern="/controllers/repventasnetasxcliente/startup.agnux" access="ROLE_ADMIN,ROLE_CXC_REPORTE_VENTAS" />
        <intercept-url pattern="/controllers/repventasnetasproductofactura/startup.agnux" access="ROLE_ADMIN,ROLE_CXC_REPORTE_VENTAS" />
        <intercept-url pattern="/controllers/repprogramacionpagos/startup.agnux" access="ROLE_ADMIN, ROLE_REPORTE_PROG_PAGOS" />
        <intercept-url pattern="/controllers/repremision/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_REMISIONES" />
        <intercept-url pattern="/controllers/repinvkits/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_KITS" />
        <intercept-url pattern="/controllers/repremisionfacturada/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_REMISIONES_FACTURADAS" />
        
        
        <!--Paco-->
        <intercept-url pattern="/controllers/tiposmovinventario/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invsecciones/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invprodlineas/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/tesban/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_BANCOS" />
        <intercept-url pattern="/controllers/tescon/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/tesmovtipos/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invcom/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invpre/startup.agnux" access="ROLE_ADMIN,ROLE_LISTA_PRECIOS" />
        <intercept-url pattern="/controllers/invpreofe/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/proconfigproduccion/startup.agnux" access="ROLE_ADMIN,ROLE_CONFIG_PRODUCCION" />
        <intercept-url pattern="/controllers/propreordenproduccion/startup.agnux" access="ROLE_ADMIN,ROLE_PREORDEN_PRODUCCION" />
        <intercept-url pattern="/controllers/proordenproduccion/startup.agnux" access="ROLE_ADMIN,ROLE_ORDEN_PRODUCCION" />
        
        
        <!--Paco, Noe-->
        <intercept-url pattern="/controllers/invordpresuben/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invordsubensamble/startup.agnux" access="ROLE_ADMIN,ROLE_CONSULTAS_ALMACEN" />
        
        
        <!--Luis y vale (duo dinamico)-->
        <intercept-url pattern="/controllers/invmarcas/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invplazas/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invzonas/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invprodgrupos/startup.agnux" access="ROLE_ADMIN" />
        <intercept-url pattern="/controllers/invplazassucursales/startup.agnux" access="ROLE_ADMIN" />
        
        
        <!--Luis Garcia-->
        <intercept-url pattern="/controllers/repestadisticasanualesventas/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_ESTADISTICO_VENTAS" />
        <intercept-url pattern="/controllers/repestadisticaanualventasproducto/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_ESTADISTICO_VENTAS" />
        <intercept-url pattern="/controllers/reppedidos/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_PEDIDOS" />
        <intercept-url pattern="/controllers/empleados/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_EMPLEADO" />
        <intercept-url pattern="/controllers/graldocs/startup.agnux" access="ROLE_ADMIN,ROLE_ACTUALIZA_CODIGO_ISO" />
        
        <!--Ezequiel-->
        <intercept-url pattern="/controllers/logvehiculos/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_VEHICULO" />
        <intercept-url pattern="/controllers/gralpuestos/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_PUESTO" />
        <intercept-url pattern="/controllers/gralescolaridads/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_ESCOLARIDAD" />
        <intercept-url pattern="/controllers/gralreligions/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_RELIGION" />
        <intercept-url pattern="/controllers/gralsangretipos/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_TIPO_SANGRE" />
        <intercept-url pattern="/controllers/protipoequipo/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_TIPO_EQUIPO" />
        <intercept-url pattern="/controllers/invprodequiv/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_PRODUCTOS_EQUIV" />
        
        <intercept-url pattern="/controllers/graldiasnolaborables/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_DIA_NO_LABORABLE" />
        <intercept-url pattern="/controllers/gralcateg/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_CATGORIA_EMPLEADO" />
        <intercept-url pattern="/controllers/graldeptos/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_DEPARTAMENTO" />
        <intercept-url pattern="/controllers/graldeptosturnos/startup.agnux" access="ROLE_ADMIN,ROLE_ALTA_TURNO" />
        <intercept-url pattern="/controllers/repedoctaprov/startup.agnux" access="ROLE_ADMIN,ROLE_REP_EDOCTA_PROVEEDOR" />
        
        
        <intercept-url pattern="/controllers/repcobranzadiaria/startup.agnux" access="ROLE_ADMIN,ROLE_REPORTE_COBRANZA_DIARIA" />
        
        
        <form-login 
            login-page="/index.jsp" 
            default-target-url="/controllers/home/startup.agnux"
            authentication-failure-url="/loginerror.jsp"
            always-use-default-target="true"
        />
        <logout logout-url="/controllers/home/logout.agnux"  logout-success-url="/index.jsp"  />
    </http>
    
    
    
    
    <authentication-manager>
        <authentication-provider>
            <jdbc-user-service data-source-ref="dataSource"/>
        </authentication-provider>
    </authentication-manager>
    
    
    
    
    <!--
    		users-by-username-query="SELECT username,password,enabled FROM erp_users WHERE username = ?"
		authorities-by-username-query="" />
            Especifica el proceso de autenticación mediante un formulario:
            [login-page]: URL del formulario de autenticación.
            [authentication-failure-url]: URL de la página en caso la autenticación falle. 
            [login-processing-url]: URL hacia el cual la autenticación será procesada. 
            [default-target-url]: URL hacia el cual se redirigirá el control luego de un login exitoso		
    -->
    <!--
    <security:form-login 
            login-page="/login.jsp" 
            default-target-url="/public/mostrarFormulario.htm" 
            authentication-failure-url="/loginerror.jsp"/>
            -->

    <!--  Especifica el tipo de autenticación:-->
    <!--<security:http-basic />-->

    <!--
            Especifica el tratamiento para los fines de sesión o logouts:
            [invalidate-session]: Si el proceso de logout debe de terminar la sesión(default=true) 
            [logout-url]: URL que determina el fin de sesión. 
            [logout-success-url]: URL del recurso que será mostrado una vez terminada la sesión.
    -->
    <!--
    <security:logout 
            invalidate-session="true" 
            logout-url="/public/terminarSesion.htm"
            logout-success-url="/logout.jsp"  />
    <security:remember-me/>
    --> 
    
    
    
    <!--
    <authentication-manager>
        <authentication-provider>
            <user-service>
                <user name="gpmarsan" password="marsan" authorities="ROLE_USER" />
                <user name="noe" password="noe" authorities="ROLE_ADMIN" />
            </user-service>
        </authentication-provider>
    </authentication-manager>
    -->
    
</beans:beans>
